[2024-03-19 13:03:58,574] [INFO    ] [Initialiser   ] [__init__      ] [MainThread    ] Monitoring initialized at directory /home/pi-cam42/PollinationMonitoringUnit/Monitoring_Data/Camera_42_20240319
[2024-03-19 13:03:58,575] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video duration: 600000
[2024-03-19 13:03:58,575] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video resolution: [1920, 1080]
[2024-03-19 13:03:58,575] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video fps: 30.0
[2024-03-19 13:03:58,575] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video codec: h264
[2024-03-19 13:03:58,576] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video bitrate: 17000000
[2024-03-19 13:03:58,576] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video container: h264
[2024-03-19 13:03:58,576] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video directory: /home/pi-cam42/PollinationMonitoringUnit/Monitoring_Data/Camera_42_20240319/Video_recordings
[2024-03-19 13:03:58,577] [INFO    ] [Writers       ] [__init__      ] [MainThread    ] CSVWriter initialised
[2024-03-19 13:03:58,577] [INFO    ] [main_new      ] [main          ] [MainThread    ] Starting CameraThread
[2024-03-19 13:03:58,578] [INFO    ] [main_new      ] [main          ] [MainThread    ] Starting UnitManagerThread
[2024-03-19 13:03:58,581] [INFO    ] [RaspberryPi   ] [assess_recording_capability] [CameraThread  ] Unit status: {'recorded_time': 1710813838.5782852, 'free_space': 107.643, 'cpu_temp': 60.3}
[2024-03-19 13:03:58,582] [INFO    ] [RaspberryPi   ] [assess_recording_capability] [CameraThread  ] Unit is operational
[2024-03-19 13:03:58,585] [INFO    ] [Writers       ] [log_sensor_data] [CameraThread  ] Data logged to file: /home/pi-cam42/PollinationMonitoringUnit/Monitoring_Data/Camera_42_20240319/Camera_42_20240319.csv
[2024-03-19 13:03:58,830] [INFO    ] [picamera2     ] [_initialize_camera] [CameraThread  ] Initialization successful.
[2024-03-19 13:03:58,830] [INFO    ] [picamera2     ] [_open_camera  ] [CameraThread  ] Camera now open.
[2024-03-19 13:03:58,831] [DEBUG   ] [picamera2     ] [__init__      ] [CameraThread  ] <libcamera._libcamera.CameraManager object at 0x7f99e7d770>
[2024-03-19 13:03:58,835] [DEBUG   ] [picamera2     ] [configure_    ] [CameraThread  ] Requesting configuration: {'use_case': 'video', 'transform': <libcamera.Transform 'vflip'>, 'colour_space': <libcamera.ColorSpace 'Rec709'>, 'buffer_count': 6, 'queue': True, 'main': {'format': 'XBGR8888', 'size': (1920, 1080), 'stride': 7680, 'framesize': 8294400}, 'lores': None, 'raw': {'format': 'SGRBG10_CSI2P', 'size': (2304, 1296), 'stride': 2880, 'framesize': 3732480}, 'controls': {'NoiseReductionMode': <NoiseReductionModeEnum.Fast: 1>, 'FrameDurationLimits': (33333, 33333)}, 'sensor': {'bit_depth': 10, 'output_size': (2304, 1296)}, 'display': 'main', 'encode': 'main'}
[2024-03-19 13:03:58,836] [INFO    ] [picamera2     ] [configure_    ] [CameraThread  ] Camera configuration has been adjusted!
[2024-03-19 13:03:58,842] [INFO    ] [picamera2     ] [configure_    ] [CameraThread  ] Configuration successful!
[2024-03-19 13:03:58,843] [DEBUG   ] [picamera2     ] [configure_    ] [CameraThread  ] Final configuration: {'use_case': 'video', 'transform': <libcamera.Transform 'vflip'>, 'colour_space': <libcamera.ColorSpace 'Rec709'>, 'buffer_count': 6, 'queue': True, 'main': {'format': 'XBGR8888', 'size': (1920, 1080), 'stride': 7680, 'framesize': 8294400}, 'lores': None, 'raw': {'format': 'SGRBG10_CSI2P', 'size': (2304, 1296), 'stride': 2880, 'framesize': 3732480}, 'controls': {'NoiseReductionMode': <NoiseReductionModeEnum.Fast: 1>, 'FrameDurationLimits': (33333, 33333)}, 'sensor': {'bit_depth': 10, 'output_size': (2304, 1296)}, 'display': 'main', 'encode': 'main'}
[2024-03-19 13:03:58,843] [DEBUG   ] [picamera2     ] [configure_    ] [CameraThread  ] Streams: {'main': <libcamera._libcamera.Stream object at 0x7f87c24630>, 'lores': None, 'raw': <libcamera._libcamera.Stream object at 0x7f87c24670>}
[2024-03-19 13:03:58,862] [DEBUG   ] [dmaallocator  ] [allocate      ] [CameraThread  ] Allocated 6 buffers for stream 0 with fds [29, 32, 35, 38, 41, 44]
[2024-03-19 13:03:58,872] [DEBUG   ] [dmaallocator  ] [allocate      ] [CameraThread  ] Allocated 6 buffers for stream 1 with fds [47, 50, 53, 56, 59, 62]
[2024-03-19 13:03:59,020] [INFO    ] [picamera2     ] [start_        ] [CameraThread  ] Camera started
[2024-03-19 13:04:01,765] [ERROR   ] [main_new      ] [main          ] [MainThread    ] Received KeyboardInterrupt or some kind of Exception. Setting interrupt event and breaking out of infinite loop...
Traceback (most recent call last):
  File "/home/pi-cam42/PollinationMonitoringUnit/main_new.py", line 184, in main
    time.sleep(1)
KeyboardInterrupt
[2024-03-19 13:04:01,768] [WARNING ] [main_new      ] [main          ] [MainThread    ] You may have to wait a minute for all child processes to gracefully exit!
[2024-03-19 13:04:01,768] [INFO    ] [main_new      ] [main          ] [MainThread    ] Joining CameraThread
[2024-03-19 13:04:02,052] [WARNING ] [main_new      ] [<module>      ] [MainThread    ] Program terminated by user
[2024-03-19 13:04:02,076] [ERROR   ] [null_preview  ] [handle_request] [Thread-3 (thread_func)] Exception during process_requests()
Traceback (most recent call last):
  File "/usr/lib/python3/dist-packages/picamera2/previews/null_preview.py", line 85, in handle_request
    picam2.process_requests(self)
  File "/usr/lib/python3/dist-packages/picamera2/picamera2.py", line 1265, in process_requests
    encoder.encode(encoder.name, req)
  File "/usr/lib/python3/dist-packages/picamera2/encoders/encoder.py", line 210, in encode
    self._encode(stream, request)
  File "/usr/lib/python3/dist-packages/picamera2/encoders/multi_encoder.py", line 69, in _encode
    self.tasks.put(self.threads.submit(self.do_encode, request, stream))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
[2024-03-19 13:04:02,297] [INFO    ] [picamera2     ] [stop_         ] [MainThread    ] Camera stopped
[2024-03-19 13:04:02,415] [INFO    ] [picamera2     ] [close         ] [MainThread    ] Camera closed successfully.
[2024-03-19 13:04:13,016] [INFO    ] [Initialiser   ] [__init__      ] [MainThread    ] Monitoring initialized at directory /home/pi-cam42/PollinationMonitoringUnit/Monitoring_Data/Camera_42_20240319
[2024-03-19 13:04:13,017] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video duration: 600000
[2024-03-19 13:04:13,017] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video resolution: [1920, 1080]
[2024-03-19 13:04:13,017] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video fps: 30.0
[2024-03-19 13:04:13,018] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video codec: h264
[2024-03-19 13:04:13,018] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video bitrate: 17000000
[2024-03-19 13:04:13,018] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video container: h264
[2024-03-19 13:04:13,018] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video directory: /home/pi-cam42/PollinationMonitoringUnit/Monitoring_Data/Camera_42_20240319/Video_recordings
[2024-03-19 13:04:13,019] [INFO    ] [Writers       ] [__init__      ] [MainThread    ] CSVWriter initialised
[2024-03-19 13:04:13,020] [INFO    ] [main_new      ] [main          ] [MainThread    ] Starting CameraThread
[2024-03-19 13:04:13,020] [INFO    ] [main_new      ] [main          ] [MainThread    ] Starting UnitManagerThread
[2024-03-19 13:04:13,068] [INFO    ] [RaspberryPi   ] [assess_recording_capability] [CameraThread  ] Unit status: {'recorded_time': 1710813853.0207021, 'free_space': 107.643, 'cpu_temp': 61.8}
[2024-03-19 13:04:13,078] [INFO    ] [RaspberryPi   ] [assess_recording_capability] [CameraThread  ] Unit is operational
[2024-03-19 13:04:13,155] [INFO    ] [Writers       ] [log_sensor_data] [CameraThread  ] Data logged to file: /home/pi-cam42/PollinationMonitoringUnit/Monitoring_Data/Camera_42_20240319/Camera_42_20240319.csv
[2024-03-19 13:04:13,155] [INFO    ] [Camera        ] [record_video  ] [CameraThread  ] Started Video recording: /home/pi-cam42/PollinationMonitoringUnit/Monitoring_Data/Camera_42_20240319/Video_recordings/Camera_42_20240319_130413.h264
[2024-03-19 13:04:14,714] [INFO    ] [Camera        ] [record_video  ] [CameraThread  ] Video saved to /home/pi-cam42/PollinationMonitoringUnit/Monitoring_Data/Camera_42_20240319/Video_recordings/Camera_42_20240319_130413.h264
[2024-03-19 13:04:14,835] [ERROR   ] [main_new      ] [main          ] [MainThread    ] Received KeyboardInterrupt or some kind of Exception. Setting interrupt event and breaking out of infinite loop...
Traceback (most recent call last):
  File "/home/pi-cam42/PollinationMonitoringUnit/main_new.py", line 184, in main
    time.sleep(1)
KeyboardInterrupt
[2024-03-19 13:04:14,872] [WARNING ] [main_new      ] [main          ] [MainThread    ] You may have to wait a minute for all child processes to gracefully exit!
[2024-03-19 13:04:14,882] [INFO    ] [main_new      ] [main          ] [MainThread    ] Joining CameraThread
[2024-03-19 13:04:14,883] [INFO    ] [main_new      ] [run           ] [UnitManagerThread] Stopping UnitManagerThread. Stop signal received
[2024-03-19 13:04:16,725] [INFO    ] [main_new      ] [run           ] [CameraThread  ] Stopping CameraThread. Stop signal received
[2024-03-19 13:04:16,726] [INFO    ] [main_new      ] [main          ] [MainThread    ] Joining UnitManagerThread
[2024-03-19 13:04:16,727] [INFO    ] [main_new      ] [main          ] [MainThread    ] Finished processing at :  2024-03-19 13:04:16.727583
[2024-03-19 13:04:16,728] [INFO    ] [main_new      ] [main          ] [MainThread    ] Shutting down the Raspberry Pi
[2024-03-19 13:04:20,630] [INFO    ] [Initialiser   ] [__init__      ] [MainThread    ] Monitoring initialized at directory /home/pi-cam42/PollinationMonitoringUnit/Monitoring_Data/Camera_42_20240319
[2024-03-19 13:04:20,631] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video duration: 600000
[2024-03-19 13:04:20,631] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video resolution: [1920, 1080]
[2024-03-19 13:04:20,631] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video fps: 30.0
[2024-03-19 13:04:20,631] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video codec: h264
[2024-03-19 13:04:20,631] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video bitrate: 17000000
[2024-03-19 13:04:20,631] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video container: h264
[2024-03-19 13:04:20,632] [INFO    ] [Camera        ] [record_to_log ] [MainThread    ] Video directory: /home/pi-cam42/PollinationMonitoringUnit/Monitoring_Data/Camera_42_20240319/Video_recordings
[2024-03-19 13:04:20,632] [INFO    ] [Writers       ] [__init__      ] [MainThread    ] CSVWriter initialised
[2024-03-19 13:04:20,633] [INFO    ] [main_new      ] [main          ] [MainThread    ] Starting CameraThread
[2024-03-19 13:04:20,633] [INFO    ] [main_new      ] [main          ] [MainThread    ] Starting UnitManagerThread
[2024-03-19 13:04:20,637] [INFO    ] [RaspberryPi   ] [assess_recording_capability] [CameraThread  ] Unit status: {'recorded_time': 1710813860.6338303, 'free_space': 107.643, 'cpu_temp': 59.9}
[2024-03-19 13:04:20,637] [INFO    ] [RaspberryPi   ] [assess_recording_capability] [CameraThread  ] Unit is operational
[2024-03-19 13:04:20,640] [INFO    ] [Writers       ] [log_sensor_data] [CameraThread  ] Data logged to file: /home/pi-cam42/PollinationMonitoringUnit/Monitoring_Data/Camera_42_20240319/Camera_42_20240319.csv
[2024-03-19 13:04:20,886] [INFO    ] [picamera2     ] [_initialize_camera] [CameraThread  ] Initialization successful.
[2024-03-19 13:04:20,887] [INFO    ] [picamera2     ] [_open_camera  ] [CameraThread  ] Camera now open.
[2024-03-19 13:04:20,887] [DEBUG   ] [picamera2     ] [__init__      ] [CameraThread  ] <libcamera._libcamera.CameraManager object at 0x7faed24170>
[2024-03-19 13:04:20,892] [DEBUG   ] [picamera2     ] [configure_    ] [CameraThread  ] Requesting configuration: {'use_case': 'video', 'transform': <libcamera.Transform 'vflip'>, 'colour_space': <libcamera.ColorSpace 'Rec709'>, 'buffer_count': 6, 'queue': True, 'main': {'format': 'XBGR8888', 'size': (1920, 1080), 'stride': 7680, 'framesize': 8294400}, 'lores': None, 'raw': {'format': 'SGRBG10_CSI2P', 'size': (2304, 1296), 'stride': 2880, 'framesize': 3732480}, 'controls': {'NoiseReductionMode': <NoiseReductionModeEnum.Fast: 1>, 'FrameDurationLimits': (33333, 33333)}, 'sensor': {'bit_depth': 10, 'output_size': (2304, 1296)}, 'display': 'main', 'encode': 'main'}
[2024-03-19 13:04:20,892] [INFO    ] [picamera2     ] [configure_    ] [CameraThread  ] Camera configuration has been adjusted!
[2024-03-19 13:04:20,900] [INFO    ] [picamera2     ] [configure_    ] [CameraThread  ] Configuration successful!
[2024-03-19 13:04:20,901] [DEBUG   ] [picamera2     ] [configure_    ] [CameraThread  ] Final configuration: {'use_case': 'video', 'transform': <libcamera.Transform 'vflip'>, 'colour_space': <libcamera.ColorSpace 'Rec709'>, 'buffer_count': 6, 'queue': True, 'main': {'format': 'XBGR8888', 'size': (1920, 1080), 'stride': 7680, 'framesize': 8294400}, 'lores': None, 'raw': {'format': 'SGRBG10_CSI2P', 'size': (2304, 1296), 'stride': 2880, 'framesize': 3732480}, 'controls': {'NoiseReductionMode': <NoiseReductionModeEnum.Fast: 1>, 'FrameDurationLimits': (33333, 33333)}, 'sensor': {'bit_depth': 10, 'output_size': (2304, 1296)}, 'display': 'main', 'encode': 'main'}
[2024-03-19 13:04:20,902] [DEBUG   ] [picamera2     ] [configure_    ] [CameraThread  ] Streams: {'main': <libcamera._libcamera.Stream object at 0x7f94710f30>, 'lores': None, 'raw': <libcamera._libcamera.Stream object at 0x7f94571e30>}
[2024-03-19 13:04:20,921] [DEBUG   ] [dmaallocator  ] [allocate      ] [CameraThread  ] Allocated 6 buffers for stream 0 with fds [29, 32, 35, 38, 41, 44]
[2024-03-19 13:04:20,930] [DEBUG   ] [dmaallocator  ] [allocate      ] [CameraThread  ] Allocated 6 buffers for stream 1 with fds [47, 50, 53, 56, 59, 62]
[2024-03-19 13:04:21,076] [INFO    ] [picamera2     ] [start_        ] [CameraThread  ] Camera started
[2024-03-19 13:04:24,112] [ERROR   ] [main_new      ] [main          ] [MainThread    ] Received KeyboardInterrupt or some kind of Exception. Setting interrupt event and breaking out of infinite loop...
Traceback (most recent call last):
  File "/home/pi-cam42/PollinationMonitoringUnit/main_new.py", line 184, in main
    time.sleep(1)
KeyboardInterrupt
[2024-03-19 13:04:24,113] [WARNING ] [main_new      ] [main          ] [MainThread    ] You may have to wait a minute for all child processes to gracefully exit!
[2024-03-19 13:04:24,114] [INFO    ] [main_new      ] [main          ] [MainThread    ] Joining CameraThread
[2024-03-19 13:04:24,369] [WARNING ] [main_new      ] [<module>      ] [MainThread    ] Program terminated by user
[2024-03-19 13:04:24,397] [ERROR   ] [null_preview  ] [handle_request] [Thread-3 (thread_func)] Exception during process_requests()
Traceback (most recent call last):
  File "/usr/lib/python3/dist-packages/picamera2/previews/null_preview.py", line 85, in handle_request
    picam2.process_requests(self)
  File "/usr/lib/python3/dist-packages/picamera2/picamera2.py", line 1265, in process_requests
    encoder.encode(encoder.name, req)
  File "/usr/lib/python3/dist-packages/picamera2/encoders/encoder.py", line 210, in encode
    self._encode(stream, request)
  File "/usr/lib/python3/dist-packages/picamera2/encoders/multi_encoder.py", line 69, in _encode
    self.tasks.put(self.threads.submit(self.do_encode, request, stream))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/concurrent/futures/thread.py", line 167, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
[2024-03-19 13:04:24,580] [INFO    ] [picamera2     ] [stop_         ] [MainThread    ] Camera stopped
[2024-03-19 13:04:24,739] [INFO    ] [picamera2     ] [close         ] [MainThread    ] Camera closed successfully.
